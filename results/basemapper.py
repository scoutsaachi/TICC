from mpl_toolkits.basemap import Basemap
import matplotlib.pyplot as plt
import csv 
import matplotlib.colors as mcolors
from collections import defaultdict
import sys

# python2.7 basemapper.py old_assignments/concat_5c_500b.out  raw_data/concat/latlongLarge.csv pics/concat_5c_500b_orig.out

#concat 8
# motifs = {(0.99, 2): {(0.0, 7.0, 6.0, 0.0, 7.0): [(50876, 52306), (59739, 60282), (97578, 98066), (66554, 67947), (87545, 87928), (55604, 56127), (1896, 2449), (94809, 96426), (98746, 99977), (91117, 91898)], (0.0, 7.0, 0.0): [(61198, 61822), (49883, 50810), (76197, 77826), (10805, 11185)], (0.0, 7.0, 6.0, 0.0): [(100054, 100417), (65615, 66469), (20915, 21422), (73442, 73926), (38081, 38783)], (1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 27406), (23092, 24177), (27544, 31017)], (7.0, 6.0, 0.0, 7.0): [(97249, 97577), (85899, 86155), (7735, 8140), (62956, 63403), (7097, 7402), (32978, 33270), (72009, 72167)], (7.0, 4.0, 6.0): [(85331, 85898), (85070, 85330), (86523, 87112), (56360, 56443)], (0.0, 7.0): [(81637, 82090), (8141, 8364), (10236, 10804), (67948, 68056), (9247, 9410), (68730, 68905), (47723, 48851), (92577, 93281), (82091, 82171), (93282, 94134), (47499, 47722), (59092, 59683), (68536, 68729), (60283, 61197), (57859, 58763), (44681, 45728), (58764, 59091), (94135, 94413), (8365, 8829), (79777, 79969), (62172, 62347), (78748, 78906)], (7.0, 6.0, 0.0): [(61823, 62035), (86362, 86522), (62647, 62955)], (6.0, 0.0, 7.0): [(63430, 63819), (10032, 10235), (43915, 44361), (87130, 87415), (87929, 88177), (65225, 65614), (64251, 64616), (48973, 49746), (68154, 68535), (71259, 71570), (74792, 75094), (46242, 47498), (38784, 39120), (101111, 101372), (20156, 20888), (84463, 84640), (73927, 74759), (102691, 103338)], (0.0, 7.0, 6.0): [(31604, 32977), (94414, 94808), (44362, 44660), (11254, 11479), (5495, 5832)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(52371, 55603), (88232, 91116), (72168, 73441), (39323, 41903), (103339, 104283), (79970, 81636), (41904, 43914), (68906, 71258), (56732, 57429), (82172, 84188)], (7.0, 0.0, 7.0): [(21486, 21999), (11480, 11751)]}, (0.9, 3): {(7.0, 6.0, 0.0, 7.0): [(66718, 67947), (7097, 7402), (86361, 86578), (7735, 8140), (57770, 58763), (76059, 76319), (97249, 97577), (85897, 86155), (72009, 72167), (94857, 96426), (32978, 33270), (87111, 87415)], (6.0, 0.0, 7.0): [(63430, 63819), (51823, 52305), (62988, 63403), (31602, 32938), (64251, 64616), (84463, 84640), (71259, 71570), (38784, 39120), (74792, 75094), (60421, 61197), (87929, 88177), (101113, 101372), (5418, 5674), (62849, 62987), (102691, 103338), (10032, 10235), (20156, 20888), (68154, 68535), (65225, 65614)], (0.0, 7.0): [(68536, 68729), (58764, 59091), (8365, 8829), (94414, 94744), (62172, 62347), (94135, 94413), (78748, 78906), (79777, 79969), (10805, 10919), (61198, 61341), (59092, 59682), (74000, 74759), (67948, 68056), (81637, 82090), (44362, 44551), (92577, 93281), (44127, 44361), (10236, 10804), (8141, 8364), (68730, 68905), (82091, 82171), (11254, 11356), (9247, 9411), (21532, 21999), (44681, 45728), (93282, 94134), (11538, 11751)], (1.0, 6.0, 1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 27994), (28052, 31017), (2473, 5339)], (0.0, 7.0, 6.0, 0.0): [(65615, 66470), (38081, 38783), (100054, 100416), (73442, 73926), (62348, 62848), (61342, 62035), (20915, 21422)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(79970, 81636), (72168, 73441), (46369, 48851), (52371, 55603), (88226, 91116), (82172, 84188), (39322, 41903), (98743, 99977), (56732, 57425), (49077, 51822), (103339, 104283), (68906, 71258), (41904, 43914)], (0.0, 7.0, 6.0, 0.0, 7.0): [(97578, 98066), (91117, 91898), (87545, 87928), (59739, 60282), (1896, 2449), (55604, 56127)]}, (0.6, 4): {(1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 26545), (23092, 24177), (28313, 31017), (2630, 5339), (26546, 28181), (5833, 7096), (146, 1774)], (7.0, 6.0, 0.0, 7.0): [(32978, 33270), (62420, 62725), (7097, 7402), (21486, 21999), (86361, 86578), (97249, 97577), (72008, 72167), (11303, 11537), (8345, 8829), (7735, 8140), (20976, 21423)], (6.0, 0.0, 7.0, 6.0): [(31602, 32977), (104284, 104558), (62848, 63030), (61342, 61996), (35195, 35561)], (0.0, 7.0): [(94414, 94744), (82091, 82171), (9247, 9411), (10920, 11253), (78747, 78906), (67948, 68056), (10805, 10919), (8830, 8977), (44362, 44551), (31018, 31466), (96545, 97206), (79777, 79969), (44127, 44361), (11538, 11751), (62172, 62347), (61198, 61341)], (6.0, 0.0, 7.0): [(20155, 20889), (71259, 71569), (38784, 39120), (87130, 87415), (5417, 5674), (87929, 88177), (60420, 61197), (51823, 52305), (92237, 92388), (101111, 101372), (84463, 84640), (63430, 63819), (102690, 103338), (9022, 9217), (84657, 84813), (33980, 34434)], (0.0, 7.0, 6.0, 0.0, 7.0): [(72168, 72961), (55604, 56127), (97578, 98066), (80800, 82090), (10093, 10804), (99926, 100206), (74000, 75094), (85875, 86155), (64034, 64616), (66554, 67947), (1896, 2449), (72962, 73622), (87544, 87928), (38079, 38492), (94809, 96426), (59739, 60282), (98743, 99925), (76197, 77827), (91117, 91898), (64932, 65614), (79970, 80799), (44660, 45728)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(56732, 57429), (41904, 43914), (57737, 59683), (49076, 51822), (52371, 55603), (88205, 91116), (92577, 94413), (39322, 41903), (46369, 48851), (103339, 104283), (82172, 84188), (68193, 68905), (65615, 66553), (68906, 71258)]}, (0.99, 4): {(0.0, 7.0, 6.0, 0.0, 7.0): [(59739, 60282), (97578, 98066), (55604, 56127), (65615, 66553), (87794, 88177), (91117, 91898), (1896, 2449)], (7.0, 6.0, 0.0, 7.0): [(86362, 86578), (97249, 97577), (37960, 38281), (7735, 8140), (76059, 76319), (62956, 63403), (7097, 7402), (32978, 33270), (72009, 72167)], (6.0, 0.0, 7.0): [(63430, 63819), (94745, 94939), (64251, 64616), (71259, 71570), (74792, 75094), (99978, 100206), (65225, 65614), (84463, 84640), (87470, 87723), (43915, 44361), (87130, 87415), (85939, 86155), (5440, 5674), (46242, 47498), (20156, 20888), (102691, 103338), (99575, 99977), (51823, 52306), (50811, 51822), (48973, 49746), (68154, 68535), (98618, 99574), (38784, 39120), (101111, 101372), (10032, 10235), (73927, 74759)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(52371, 55603), (88232, 91116), (72168, 73441), (39323, 41903), (103339, 104283), (66554, 68056), (79970, 81636), (41904, 43914), (68906, 71258), (56732, 57429), (82172, 84188)], (0.0, 7.0): [(44362, 44551), (81637, 82090), (8141, 8364), (11254, 11356), (10236, 10804), (61198, 61341), (68730, 68905), (9247, 9410), (21532, 21999), (47723, 48851), (92577, 93281), (11538, 11751), (82091, 82171), (62348, 62725), (31604, 32938), (93282, 94134), (73442, 73622), (47499, 47722), (59092, 59683), (68536, 68729), (60283, 61197), (57859, 58763), (44681, 45728), (49883, 50432), (20915, 21066), (58764, 59091), (61342, 61916), (95015, 96426), (94135, 94413), (8365, 8829), (94414, 94744), (79777, 79969), (62172, 62347), (78748, 78906), (10805, 10919)]}, (0.6, 3): {(7.0, 6.0, 0.0, 7.0): [(8345, 8829), (62420, 62725), (20976, 21423), (21486, 21999), (7097, 7402), (11303, 11537), (32978, 33270), (97249, 97577), (7735, 8140), (72008, 72167)], (6.0, 0.0, 7.0, 6.0): [(104284, 104558), (35195, 35561), (62848, 63030)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(49077, 51822), (92577, 94413), (65615, 66553), (46369, 48851), (82172, 84188), (103339, 104283), (56732, 57429), (68193, 68905), (68906, 71258)], (6.0, 0.0, 7.0): [(51823, 52305), (85939, 86155), (71259, 71569), (101111, 101372), (87130, 87415), (60420, 61197), (87929, 88177), (102690, 103338), (20156, 20889), (63430, 63819), (5418, 5674), (84463, 84640), (9022, 9217)], (1.0, 6.0, 1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 27994), (23092, 24177), (28027, 31017), (2473, 5339), (5675, 7096)], (0.0, 7.0, 6.0): [(92347, 92555), (98067, 98589), (11538, 11818), (9502, 9796), (91899, 92346), (61342, 61996), (52371, 52580), (96545, 97248), (94414, 94808)], (6.0, 0.0, 7.0, 4.0, 6.0): [(104937, 107999), (86394, 87112), (85179, 85914), (31602, 32977), (84657, 85076)], (1.0, 6.0, 1.0): [(34434, 34916), (75214, 75920), (33271, 34238), (146, 1774)], (0.0, 7.0): [(61198, 61341), (9247, 9411), (10920, 11253), (78747, 78906), (67948, 68056), (10805, 10919), (8830, 8977), (79777, 79969), (44362, 44551), (62172, 62347), (90959, 91116), (31018, 31466), (82091, 82171)], (0.0, 7.0, 6.0, 0.0, 7.0): [(57859, 59683), (88205, 90958), (52581, 55603), (72168, 72961), (55604, 56127), (97578, 98066), (80800, 82090), (99926, 100206), (40161, 41903), (74000, 75094), (10093, 10804), (43214, 44361), (38815, 39953), (41904, 43213), (64034, 64616), (1896, 2449), (66554, 67947), (87544, 87928), (72962, 73622), (38079, 38492), (94809, 96426), (98743, 99925), (76197, 77827), (64933, 65614), (91117, 91898), (59739, 60282), (79970, 80799), (44661, 45728)]}, (0.9, 4): {(7.0, 6.0, 0.0, 7.0): [(97249, 97577), (7097, 7402), (72009, 72167), (7735, 8140), (86362, 86578), (37960, 38281), (76059, 76319), (32978, 33270)], (1.0, 6.0, 1.0, 6.0, 1.0): [(2630, 5339), (23092, 24177), (24466, 27406), (5833, 7096), (28313, 31017)], (0.0, 7.0, 6.0, 0.0, 7.0): [(55604, 56127), (1896, 2449), (87545, 87928), (97578, 98066), (91117, 91898), (65615, 66553), (59739, 60282)], (6.0, 0.0, 7.0): [(63430, 63819), (51823, 52305), (31602, 32938), (84463, 84640), (38784, 39120), (60421, 61197), (87130, 87415), (87929, 88177), (20156, 20888), (102691, 103338), (101113, 101372), (5418, 5674), (94745, 94939), (85939, 86155), (62988, 63403), (99978, 100206), (64251, 64616), (71259, 71570), (74792, 75094), (62848, 62987), (10032, 10235), (65225, 65614), (68154, 68535)], (0.0, 7.0): [(68536, 68729), (58764, 59091), (20915, 21066), (8365, 8829), (62172, 62347), (94135, 94413), (94414, 94744), (61342, 61916), (78748, 78906), (79777, 79969), (10805, 10919), (61198, 61341), (59092, 59682), (74000, 74759), (11538, 11751), (81637, 82090), (10236, 10804), (92577, 93281), (44127, 44361), (44362, 44551), (8141, 8364), (82091, 82171), (68730, 68905), (11254, 11356), (57859, 58763), (9247, 9411), (21532, 21999), (44681, 45728), (73442, 73622), (93282, 94134), (62348, 62725), (95015, 96426)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(66554, 68056), (72168, 73441), (79970, 81636), (46369, 48851), (52371, 55603), (88232, 91116), (82172, 84188), (39322, 41903), (98743, 99977), (56732, 57425), (49077, 51822), (103339, 104283), (68906, 71258), (41904, 43914)]}, (0.9, 2): {(1.0, 6.0, 1.0, 6.0, 1.0): [(5833, 7096), (23092, 24177)], (7.0, 6.0, 0.0, 7.0): [(76059, 76319), (97249, 97577), (85897, 86155), (62956, 63403), (72009, 72167), (32978, 33270), (86361, 86578), (7735, 8140), (7097, 7402)], (6.0, 0.0, 7.0): [(84463, 84640), (63430, 63819), (64251, 64616), (68154, 68535), (31602, 32938), (71259, 71570), (38784, 39120), (101113, 101372), (60421, 61197), (87929, 88177), (5418, 5674), (87130, 87415), (10032, 10235), (102691, 103338), (20156, 20889), (52306, 52459), (65225, 65614)], (0.0, 7.0): [(68536, 68729), (58764, 59091), (90959, 91116), (8365, 8829), (94414, 94744), (62172, 62347), (94135, 94413), (78748, 78906), (79777, 79969), (40782, 41903), (10805, 10919), (61198, 61341), (67948, 68056), (59092, 59683), (8141, 8364), (81637, 82090), (10236, 10804), (68730, 68905), (82091, 82171), (92577, 93281), (9247, 9411), (57859, 58763), (44681, 45728), (93282, 94134)], (7.0, 6.0, 0.0): [(62647, 62955), (9529, 10031)], (1.0, 6.0, 1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 27994), (28052, 31017), (2473, 5339)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(103339, 104283), (46369, 48851), (82172, 84188), (72168, 73441), (79970, 81636), (98744, 99977), (68906, 71258), (56732, 57425)], (7.0, 0.0, 7.0): [(11480, 11751), (21486, 21999), (11217, 11356)], (0.0, 7.0, 6.0, 0.0): [(65615, 66470), (38081, 38783), (100054, 100416), (73442, 73926), (20915, 21422), (61342, 62035)], (0.0, 7.0, 6.0, 0.0, 7.0): [(1896, 2449), (88232, 90958), (49077, 50432), (52581, 55603), (43214, 44361), (97578, 98066), (94809, 96426), (39322, 40781), (91117, 91898), (41904, 43213), (59739, 60282), (87545, 87928), (74000, 75094), (66554, 67947), (55604, 56127), (50433, 52305)]}, (0.99, 3): {(1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 27406), (23092, 24177), (27544, 31017)], (7.0, 6.0, 0.0, 7.0): [(86362, 86578), (97249, 97577), (7735, 8140), (76059, 76319), (62956, 63403), (7097, 7402), (32978, 33270), (72009, 72167)], (7.0, 4.0, 6.0): [(85331, 85898), (85070, 85330), (56360, 56443)], (0.0, 7.0): [(44362, 44551), (81637, 82090), (8141, 8364), (11254, 11356), (10236, 10804), (61198, 61341), (67948, 68056), (68730, 68905), (9247, 9410), (21532, 21999), (47723, 48851), (46369, 47498), (92577, 93281), (11538, 11751), (82091, 82171), (74000, 74759), (62348, 62725), (31604, 32938), (93282, 94134), (47499, 47722), (59092, 59683), (68536, 68729), (60283, 61197), (57859, 58763), (44681, 45728), (49883, 50432), (58764, 59091), (94135, 94413), (8365, 8829), (94414, 94744), (79777, 79969), (62172, 62347), (78748, 78906), (10805, 10919)], (6.0, 0.0, 7.0): [(63430, 63819), (43915, 44361), (87130, 87415), (65225, 65614), (64251, 64616), (85939, 86155), (48973, 49746), (68154, 68535), (71259, 71570), (74792, 75094), (5440, 5674), (38784, 39120), (101111, 101372), (20156, 20888), (84463, 84640), (10032, 10235), (102691, 103338), (87929, 88177)], (0.0, 7.0, 6.0, 0.0, 7.0): [(50876, 52306), (59739, 60282), (97578, 98066), (66554, 67947), (87545, 87928), (55604, 56127), (1896, 2449), (94809, 96426), (98746, 99977), (91117, 91898)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(52371, 55603), (88232, 91116), (72168, 73441), (39323, 41903), (103339, 104283), (79970, 81636), (41904, 43914), (68906, 71258), (56732, 57429), (82172, 84188)], (0.0, 7.0, 6.0, 0.0): [(100054, 100417), (65615, 66469), (20915, 21422), (73442, 73926), (61342, 62035), (38081, 38783)]}, (0.6, 2): {(0.0, 7.0, 6.0): [(9502, 9796), (11538, 11818), (91899, 92346), (52371, 52580), (96545, 97248), (92347, 92555), (94414, 94808)], (7.0, 6.0, 0.0, 7.0): [(8345, 8829), (62420, 62725), (20976, 21423), (21486, 21999), (7097, 7402), (11303, 11537), (32978, 33270), (7735, 8140), (97249, 97577), (72008, 72167)], (6.0, 0.0, 7.0, 6.0): [(62848, 63030), (35195, 35561), (104284, 104558)], (0.0, 7.0): [(31018, 31466), (82091, 82171), (10920, 11253), (9247, 9411), (78747, 78906), (67948, 68056), (62172, 62347), (10805, 10919), (8830, 8977), (44127, 44361), (79777, 79969), (44362, 44551), (90959, 91116), (61198, 61341)], (6.0, 0.0, 7.0): [(85939, 86155), (51823, 52305), (38784, 39120), (87130, 87415), (71259, 71569), (87929, 88177), (60420, 61197), (5418, 5674), (84463, 84640), (63430, 63819), (102690, 103338), (9022, 9217), (101111, 101372), (20156, 20889)], (1.0, 6.0, 1.0, 6.0, 1.0, 6.0, 1.0): [(24466, 27994), (23092, 24177), (28027, 31017), (2473, 5339), (5675, 7096)], (0.0, 7.0, 6.0, 0.0, 7.0, 0.0, 7.0): [(41904, 43914), (49077, 51822), (39322, 41903), (46369, 48851), (92577, 94413), (103339, 104283), (82172, 84188), (56732, 57429), (65615, 66553), (68193, 68905), (68906, 71258)], (6.0, 0.0, 7.0, 4.0, 6.0): [(104937, 107999), (85179, 85914), (86394, 87112), (84657, 85076), (31602, 32977)], (1.0, 6.0, 1.0): [(75214, 75920), (33271, 34238), (34434, 34916), (146, 1774)], (0.0, 7.0, 6.0, 0.0): [(98067, 98533), (61342, 62035)], (0.0, 7.0, 6.0, 0.0, 7.0): [(57859, 59683), (88205, 90958), (52581, 55603), (72168, 72961), (55604, 56127), (97578, 98066), (80800, 82090), (99926, 100206), (74000, 75094), (10093, 10804), (1896, 2449), (66554, 67947), (64034, 64616), (87544, 87928), (72962, 73622), (38079, 38492), (94809, 96426), (98743, 99925), (76197, 77827), (59739, 60282), (64932, 65614), (91117, 91898), (79970, 80799), (44661, 45728)]}}

# concat 5
# motifs = {(0.99, 2): {(3.0, 2.0, 0.0): [(87893, 88165), (56322, 56656), (57774, 58496), (76059, 77825), (52232, 52878), (62957, 63266)], (2.0, 1.0, 2.0, 1.0, 3.0, 2.0, 1.0): [(2473, 7096), (27994, 33978)], (2.0, 0.0, 3.0): [(87471, 87722), (101079, 101373), (64250, 64616), (68153, 68534), (65219, 65614)], (0.0, 3.0, 2.0, 0.0, 3.0): [(98720, 99979), (100038, 100499), (53132, 56126), (96544, 97577), (91117, 91898), (70893, 71569), (73678, 75092), (97578, 98065), (59739, 60282)], (1.0, 3.0, 1.0, 3.0, 2.0): [(20234, 21156), (8365, 9138)], (1.0, 3.0, 1.0): [(11537, 11855), (21531, 23525), (23669, 25853), (10804, 11216), (9705, 10770), (0, 2121), (9139, 9378), (7655, 8108)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0): [(103338, 104285), (88188, 91116), (82171, 84188), (41904, 43913), (72167, 73441), (49022, 51823), (94414, 96426)], (0.0, 3.0, 2.0): [(57009, 57581), (86028, 86360), (56733, 57008), (37984, 38393)], (0.0, 3.0, 0.0, 3.0, 0.0): [(46366, 48725), (92577, 94360)], (3.0, 2.0, 0.0, 3.0): [(63360, 63819), (39039, 39953), (87111, 87415)], (0.0, 3.0): [(71570, 72050), (73442, 73622), (68730, 68905), (61198, 61900), (70634, 70772), (78685, 78905), (68535, 68729), (68906, 70633), (66811, 67946), (40781, 41903), (44681, 45728), (62209, 62347), (60283, 61197), (65615, 65763), (62475, 62757), (72051, 72166), (102903, 103337), (79777, 80360)], (3.0, 4.0, 2.0): [(35951, 36902), (37656, 37959), (85347, 86027), (84578, 85346), (101568, 102902), (86523, 87110), (19018, 20233)], (2.0, 0.0, 3.0, 0.0): [(65764, 66737), (43914, 44443), (80361, 82060)]}, (0.9, 3): {(3.0, 2.0, 0.0): [(87893, 88165), (52232, 52878), (56322, 56656), (62957, 63266), (76059, 77825), (57774, 58496)], (2.0, 0.0, 3.0): [(43914, 44360), (68153, 68534), (70602, 70772), (63429, 63819), (87471, 87722), (64250, 64616), (65764, 66553), (101079, 101373), (87130, 87415), (39121, 39953), (65219, 65614)], (0.0, 3.0, 2.0, 0.0, 3.0): [(59739, 60282), (98720, 99979), (100038, 100499), (96544, 97577), (70893, 71569), (53132, 56126), (97578, 98065), (73678, 75092), (91117, 91898)], (3.0, 4.0, 2.0): [(12084, 18971), (37656, 37959), (86523, 87110), (84578, 85346), (85347, 86028), (101568, 102902), (19018, 20233), (35951, 36902)], (0.0, 3.0): [(47499, 47721), (38394, 39120), (93281, 94134), (68535, 68729), (102903, 103337), (62209, 62347), (46366, 47498), (92577, 93280), (61198, 61900), (73442, 73622), (78685, 78905), (44681, 45728), (40780, 41903), (60283, 61197), (68730, 68905), (94135, 94413), (72051, 72166), (80552, 81636), (81637, 82170), (66811, 67946), (65615, 65763), (62475, 62757), (71570, 72050), (47722, 48851)], (1.0, 3.0, 1.0): [(21531, 23525), (5822, 7280), (23669, 25853), (9139, 9378), (11537, 11855), (7655, 8108), (0, 2121), (20234, 20975), (9705, 10770), (10804, 11216), (8141, 8772)], (0.0, 3.0, 2.0): [(56733, 57008), (79777, 80551), (44361, 44660), (37984, 38393), (57009, 57581)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0): [(94414, 96426), (88187, 91116), (103338, 104285), (82171, 84188), (41904, 43913), (49022, 51823), (72167, 73441)]}, (0.6, 4): {(0.0, 3.0, 2.0, 0.0, 3.0, 0.0): [(82171, 83986), (76022, 77825), (88187, 91055), (92577, 94360), (46366, 48725), (72167, 73418), (41904, 43815), (57009, 57773), (49022, 51770), (44361, 45607)], (2.0, 0.0, 3.0): [(68153, 68534), (60415, 61197), (65764, 66553), (65219, 65614), (70603, 70772), (64249, 64618), (94745, 94939), (5418, 5674), (101079, 101373), (40779, 41903), (92390, 92576)], (2.0, 1.0, 3.0, 1.0): [(9022, 9378), (25854, 27993), (33979, 34937), (27994, 30140), (11357, 11732)], (3.0, 2.0, 0.0, 3.0): [(80284, 81636), (37960, 38282), (103433, 103980), (39039, 39953), (43816, 44360), (63360, 63819), (87893, 88186)], (3.0, 4.0, 2.0): [(12084, 18971), (101568, 102902), (104775, 107999), (85347, 86028), (19018, 20233), (37656, 37959), (84578, 85346), (83987, 84577), (86523, 87110), (35951, 37379)], (0.0, 3.0): [(62209, 62347), (62758, 62992), (56733, 56940), (71570, 72050), (65615, 65763), (81637, 82170), (61198, 61900), (51824, 52305), (68906, 70602), (68730, 68905), (73442, 73622), (102903, 103337), (62475, 62757), (78685, 78905), (72051, 72166), (68535, 68729), (103981, 104285)], (0.0, 3.0, 2.0, 0.0, 3.0): [(100038, 100499), (66554, 67946), (98720, 99979), (87181, 87722), (59739, 60282), (73677, 75092), (96544, 97577), (91117, 91898), (70892, 71569), (53132, 56127), (97578, 98065), (94940, 96543)], (1.0, 3.0, 1.0): [(8141, 8772), (2595, 5417), (21531, 23525), (10804, 11216), (23669, 25853), (0, 2121), (30385, 32977), (5822, 7280), (7655, 8108), (9705, 10770)]}, (0.99, 4): {(0.0, 3.0, 2.0, 0.0, 3.0, 0.0): [(88188, 91055), (91117, 92236), (103338, 104227), (72167, 73418), (94414, 96267), (41904, 43815), (49022, 51770), (82171, 83986)], (3.0, 2.0, 0.0, 3.0): [(87111, 87415), (43816, 44360), (63360, 63819), (39039, 39953), (87893, 88187), (80284, 81636)], (1.0, 3.0, 1.0): [(11537, 11855), (21531, 23525), (23669, 25853), (10804, 11216), (5822, 7280), (9705, 10770), (20234, 20975), (8141, 8772), (0, 2121), (9139, 9378), (7655, 8108)], (0.0, 3.0): [(87535, 87722), (61198, 61900), (46366, 47498), (65847, 66553), (68906, 70633), (92577, 93280), (65395, 65614), (73442, 73622), (78685, 78905), (40781, 41903), (44681, 45728), (68730, 68905), (60283, 61197), (72051, 72166), (101166, 101373), (94135, 94413), (81637, 82170), (66811, 67946), (62475, 62757), (65615, 65763), (68211, 68534), (71570, 72050), (70634, 70772), (47499, 47721), (47722, 48851), (68535, 68729), (62209, 62347), (93281, 94134), (102903, 103337)], (0.0, 3.0, 2.0, 0.0, 3.0): [(98720, 99979), (100038, 100499), (53132, 56126), (96544, 97577), (70893, 71569), (73678, 75092), (97578, 98065), (59739, 60282)], (3.0, 4.0, 2.0): [(35951, 36902), (64526, 64931), (37656, 37959), (83987, 84577), (85347, 86027), (84578, 85346), (101568, 102902), (86523, 87110), (19018, 20233)], (0.0, 3.0, 2.0): [(37984, 38393), (44361, 44660), (86028, 86360), (62758, 63030), (57009, 57581), (57631, 57857), (56733, 57008)]}, (0.6, 3): {(2.0, 0.0, 3.0): [(60415, 61197), (87929, 88182), (62990, 63428), (65219, 65614), (37983, 38282), (68153, 68534), (40779, 41903), (65764, 66553), (64249, 64616), (63429, 63819), (39121, 39953), (43914, 44360), (94745, 94939), (70603, 70772), (87723, 87928), (101079, 101373), (87471, 87722), (87130, 87415), (38283, 39120)], (2.0, 1.0, 3.0, 1.0): [(25855, 27993), (0, 2121), (33980, 34937)], (0.0, 3.0, 2.0, 0.0, 3.0): [(94940, 96543), (98720, 99979), (59739, 60282), (73678, 75092), (100038, 100499), (53132, 56127), (91117, 91898), (97578, 98066), (70892, 71569), (96544, 97577), (66554, 67946)], (0.0, 3.0): [(62209, 62347), (62475, 62757), (68906, 70602), (68730, 68905), (56733, 56940), (73442, 73622), (78685, 78905), (71570, 72050), (72051, 72166), (68535, 68729), (65615, 65763), (51824, 52305), (61198, 61900)], (1.0, 3.0, 2.0, 1.0, 3.0, 1.0, 3.0): [(28313, 32991), (7655, 8364), (9422, 10803), (22001, 25854), (2596, 7403), (20890, 22000), (10920, 11766), (8365, 9421)], (3.0, 4.0, 2.0): [(12084, 18971), (101568, 102902), (86523, 87110), (19018, 20233), (104775, 107999), (37656, 37959), (84578, 85346), (85347, 86028), (35951, 37379)], (3.0, 0.0, 3.0, 2.0, 0.0, 3.0, 0.0): [(103298, 104227), (79956, 82060), (75916, 77825)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0): [(49022, 51823), (72167, 73441), (88187, 91116), (92577, 94413), (46366, 48851), (82171, 84188), (57009, 57799), (41904, 43913), (44361, 45728)]}, (0.9, 4): {(0.0, 3.0, 2.0, 0.0, 3.0, 0.0): [(88188, 91055), (103338, 104227), (41904, 43815), (91117, 92236), (72167, 73418), (49022, 51770), (94414, 96267), (82171, 83986)], (3.0, 2.0, 0.0, 3.0): [(43816, 44360), (87111, 87415), (87893, 88187), (63360, 63819), (37960, 38282), (39039, 39953), (80284, 81636)], (1.0, 3.0, 1.0): [(21531, 23525), (23669, 25853), (9705, 10770), (9139, 9378), (0, 2121), (7655, 8108), (20234, 20975), (10804, 11216), (5822, 7280), (8141, 8772), (11537, 11855)], (0.0, 3.0): [(70634, 70772), (47499, 47721), (71570, 72050), (102903, 103337), (68535, 68729), (46366, 47498), (62209, 62347), (92577, 93280), (87536, 87722), (61198, 61900), (65395, 65614), (65847, 66553), (73442, 73622), (44681, 45728), (40781, 41903), (68906, 70633), (78685, 78905), (94135, 94413), (66811, 67946), (60283, 61197), (68730, 68905), (101166, 101373), (72051, 72166), (81637, 82170), (65615, 65763), (62475, 62757), (47722, 48851), (68211, 68534), (93281, 94134)], (0.0, 3.0, 2.0, 0.0, 3.0): [(70893, 71569), (73678, 75092), (98721, 99979), (59739, 60282), (97578, 98065), (100038, 100499), (96544, 97577), (53132, 56126)], (3.0, 4.0, 2.0): [(12084, 18971), (35951, 36902), (101568, 102902), (37656, 37959), (19018, 20233), (83987, 84577), (86523, 87110), (85347, 86028), (84578, 85346), (64526, 64932)], (0.0, 3.0, 2.0): [(57009, 57581), (86029, 86360), (56733, 57008), (51824, 52578), (62758, 63030), (44361, 44660), (57631, 57857)]}, (0.9, 2): {(3.0, 2.0, 0.0): [(56322, 56656), (76059, 77825), (57774, 58496), (62957, 63266), (52232, 52878)], (2.0, 1.0, 2.0, 1.0, 3.0, 2.0, 1.0): [(27994, 33978), (2473, 7096)], (2.0, 0.0, 3.0): [(65219, 65614), (87471, 87722), (68153, 68534), (70602, 70772), (101079, 101373), (64250, 64616)], (0.0, 3.0, 2.0, 0.0, 3.0): [(59739, 60282), (70893, 71569), (98721, 99979), (100038, 100499), (97578, 98065), (53132, 56126), (96544, 97577), (73678, 75092), (91117, 91898)], (1.0, 3.0, 1.0, 3.0, 2.0): [(8365, 9138), (20234, 21156)], (1.0, 3.0, 1.0): [(21531, 23525), (23669, 25853), (7655, 8108), (9139, 9378), (0, 2121), (9705, 10770), (10804, 11216), (11537, 11855)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0): [(88187, 91116), (94414, 96426), (82171, 84188), (103338, 104285), (41904, 43913), (49022, 51823), (72167, 73441)], (0.0, 3.0, 2.0): [(57009, 57581), (86029, 86360), (56733, 57008)], (0.0, 3.0, 0.0, 3.0, 0.0): [(92577, 94360), (46366, 48725)], (3.0, 2.0, 0.0, 3.0): [(87111, 87415), (87893, 88186), (63360, 63819), (39039, 39953), (37960, 38282)], (0.0, 3.0): [(79777, 80360), (78685, 78905), (66811, 67946), (44681, 45728), (71570, 72050), (68535, 68729), (40781, 41903), (102903, 103337), (61198, 61900), (60283, 61197), (68730, 68905), (62209, 62347), (65615, 65763), (62475, 62757), (72051, 72166), (73442, 73622)], (3.0, 4.0, 2.0): [(12084, 18971), (37656, 37959), (101568, 102902), (85347, 86028), (84578, 85346), (86523, 87110), (19018, 20233), (35951, 36902)], (2.0, 0.0, 3.0, 0.0): [(80361, 82060), (43914, 44443), (65764, 66737)]}, (0.99, 3): {(3.0, 2.0, 0.0): [(87893, 88165), (56322, 56656), (57774, 58496), (76059, 77825), (52232, 52878), (62957, 63266)], (2.0, 0.0, 3.0): [(63429, 63819), (87471, 87722), (101079, 101373), (64250, 64616), (65219, 65614), (68153, 68534), (65764, 66553), (87130, 87415), (39121, 39953), (43914, 44360)], (0.0, 3.0, 2.0, 0.0, 3.0): [(98720, 99979), (100038, 100499), (53132, 56126), (96544, 97577), (91117, 91898), (70893, 71569), (73678, 75092), (97578, 98065), (59739, 60282)], (3.0, 4.0, 2.0): [(35951, 36902), (37656, 37959), (85347, 86027), (84578, 85346), (101568, 102902), (86523, 87110), (19018, 20233)], (0.0, 3.0): [(61198, 61900), (46366, 47498), (68906, 70633), (92577, 93280), (73442, 73622), (78685, 78905), (40781, 41903), (44681, 45728), (68730, 68905), (60283, 61197), (72051, 72166), (94135, 94413), (80552, 81636), (81637, 82170), (66811, 67946), (62475, 62757), (65615, 65763), (71570, 72050), (38394, 39120), (70634, 70772), (47499, 47721), (47722, 48851), (68535, 68729), (62209, 62347), (93281, 94134), (102903, 103337)], (1.0, 3.0, 1.0): [(11537, 11855), (21531, 23525), (23669, 25853), (10804, 11216), (5822, 7280), (9705, 10770), (20234, 20975), (8141, 8772), (0, 2121), (9139, 9378), (7655, 8108)], (0.0, 3.0, 2.0): [(37984, 38393), (44361, 44660), (86028, 86360), (57009, 57581), (79777, 80551), (56733, 57008)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0): [(103338, 104285), (88188, 91116), (82171, 84188), (41904, 43913), (72167, 73441), (49022, 51823), (94414, 96426)]}, (0.6, 2): {(1.0, 3.0, 2.0, 1.0, 3.0, 1.0, 3.0): [(28313, 32991), (9421, 10803), (7655, 8364), (20890, 22000), (22001, 25854), (2596, 7403), (8365, 9420)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0): [(76022, 77825), (49022, 51770), (46366, 48725), (92577, 94360), (72167, 73418)], (2.0, 0.0, 3.0): [(43914, 44360), (92390, 92576), (65219, 65614), (68153, 68534), (60415, 61197), (65764, 66553), (70603, 70772), (87471, 87722), (94745, 94939), (64249, 64616), (40779, 41903), (101079, 101373)], (2.0, 1.0, 3.0, 1.0): [(33980, 34937), (11357, 11732), (0, 2121), (25855, 27993)], (3.0, 2.0, 0.0, 3.0): [(87111, 87415), (87893, 88186), (37960, 38282), (39039, 39953), (63360, 63819)], (0.0, 3.0): [(51824, 52305), (61198, 61900), (68730, 68905), (68906, 70602), (78685, 78905), (73442, 73622), (65615, 65763), (72051, 72166), (68535, 68729), (71570, 72050), (62209, 62347)], (0.0, 3.0, 2.0, 0.0, 3.0): [(98720, 99979), (66554, 67946), (100038, 100499), (59739, 60282), (97578, 98066), (96544, 97577), (91117, 91898), (73677, 75092), (70892, 71569), (53132, 56127), (94940, 96543)], (3.0, 4.0, 2.0): [(12084, 18971), (35951, 37379), (101568, 102902), (104775, 107999), (19018, 20233), (37656, 37959), (85347, 86028), (84578, 85346), (86523, 87110)], (3.0, 0.0, 3.0, 2.0, 0.0, 3.0, 0.0): [(103298, 104227), (79956, 82060)], (0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0): [(82171, 84188), (57009, 57799), (44361, 45728), (41904, 43913), (88187, 91116)], (0.0, 3.0, 2.0): [(62475, 62763), (62764, 63030), (56733, 57008)]}}

#concat heavy switch
# motifs = {(0.99, 2): {(1.0, 2.0, 1.0): [(33105, 34879), (24190, 27358), (28313, 32818)], (2.0, 0.0, 3.0): [(52306, 55783), (99573, 100536), (72673, 72960), (74760, 75092), (102688, 103527), (43913, 44680), (38283, 39119), (65219, 65795)], (0.0, 3.0, 0.0, 3.0, 0.0): [(92577, 94360), (80553, 82877), (88630, 91850), (49823, 52231), (72961, 74642)], (0.0, 3.0, 0.0): [(42568, 43815), (97810, 98403), (46367, 48726), (40780, 42368)], (0.0, 3.0): [(39260, 39952), (66554, 67945), (72064, 72672), (101161, 101622), (87984, 88193), (61197, 61899), (64367, 64618), (97362, 97694), (94413, 94939), (63026, 63509), (44681, 45728), (68535, 68905), (98721, 99572), (49022, 49822), (60282, 61196), (65796, 66553), (38028, 38282), (96544, 97361), (67946, 68534), (70773, 71257), (103981, 104800), (83623, 84188), (87512, 87983), (103528, 103980), (55784, 56127), (57008, 57857), (68906, 70772), (62348, 63025), (63510, 63818), (71570, 72063), (88194, 88629), (83084, 83622), (62172, 62347), (79777, 80359), (71359, 71569), (59739, 60012), (94940, 96543)], (1.0, 3.0, 1.0): [(0, 2121), (10920, 11732), (5823, 7281), (10236, 10892), (8141, 8773), (21531, 23524), (9218, 10224)]}, (0.4, 2): {(3.0, 0.0, 3.0, 0.0, 3.0): [(40742, 42411), (49707, 51823), (93235, 94412)], (2.0, 0.0, 3.0): [(55693, 56128), (43913, 44679), (66738, 67945), (63429, 63935), (85826, 86577), (56452, 56939), (63936, 64618), (101080, 101623), (65764, 66553)], (1.0, 3.0, 2.0): [(34190, 36371), (99905, 100928)], (0.0, 3.0, 0.0, 3.0, 2.0, 0.0, 3.0, 0.0, 3.0, 4.0): [(102903, 107999), (11216, 20043)], (0.0, 3.0, 0.0): [(42567, 43815), (65394, 65726), (46366, 48726)], (1.0, 3.0, 1.0): [(26502, 27994), (7803, 8344), (58497, 59739), (10235, 10892)], (3.0, 0.0): [(62649, 62956), (62957, 63361), (48727, 49706), (68878, 70316), (87677, 88165), (68493, 68877), (72592, 72889), (78849, 78985)], (1.0, 3.0, 1.0, 3.0, 1.0): [(28313, 33980), (22001, 25855), (0, 5590)], (0.0, 3.0, 0.0, 3.0, 0.0): [(82170, 83987), (88193, 91436), (94940, 97537), (72960, 74642)], (2.0, 1.0): [(9624, 10224), (74760, 75057), (75093, 75920), (7404, 7734), (21067, 21485), (78986, 79777), (20111, 20840), (5675, 7096)], (0.0, 3.0): [(80551, 81636), (87173, 87511), (94413, 94939), (71358, 71569), (91513, 91898), (60282, 61196), (71570, 72063), (38394, 39119), (70773, 71357), (97809, 98065), (62172, 62347), (44681, 45728), (76198, 77826), (39260, 39952)], (0.0, 3.0, 2.0): [(98721, 99741), (37984, 38393), (57009, 57858), (91899, 92553), (98066, 98720), (61197, 62108), (51895, 52578)]}, (0.6, 2): {(1.0, 3.0, 1.0, 3.0, 1.0): [(0, 5590), (20234, 21983), (22001, 25852), (28313, 33978)], (2.0, 0.0, 3.0): [(102688, 103527), (52306, 55692), (66738, 67945), (38288, 39119), (56452, 56939), (74760, 75092), (99573, 100536), (43913, 44680), (56940, 57857), (101080, 101622), (64770, 65795), (55693, 56127)], (0.0, 3.0, 0.0, 3.0, 4.0): [(103528, 107999), (11216, 20043)], (0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0): [(80552, 83987), (46367, 51770)], (3.0, 0.0): [(87677, 88165), (51771, 52231), (75921, 77825), (59684, 59954), (78849, 78985), (68878, 70316), (88166, 88481), (68493, 68877)], (3.0, 4.0, 2.0): [(84579, 85346), (85347, 86119), (86120, 87109), (83988, 84578)], (0.0, 3.0, 0.0, 3.0, 0.0, 3.0, 0.0): [(92577, 94725), (72749, 74642), (88631, 92236), (40742, 43815)], (1.0, 3.0, 1.0): [(7803, 8344), (9669, 10770), (8365, 9378)], (0.0, 3.0): [(61197, 62171), (63511, 63818), (97362, 97694), (62172, 62347), (62348, 63027), (79777, 80359), (63028, 63510), (60282, 61196), (94941, 96543), (97809, 98065), (44681, 45728), (71358, 71569), (96544, 97361), (98718, 99572), (87177, 87532), (72065, 72748), (98066, 98717), (39260, 39952), (65796, 66553), (71570, 72064), (70773, 71357), (64367, 64618)], (3.0, 4.0, 3.0, 2.0): [(34880, 37380), (37381, 38250)]}}

colormap = ['blue', 'red', 'green','orange','purple','teal', 'yellow', 'cyan', 'pink', 'gray', 'beige', 'lightpink', 'darkgoldenrod', 'navy', 'deepskyblue', 'lightslategray', 'lavenderblush', 'olivedrab']
# colormap = mcolors.CSS4_COLORS.keys()

input_name, latlongname, output_name = sys.argv[1], sys.argv[2], sys.argv[3]
motifValue = None
if len(sys.argv) == 6:
    motifDictIndex = (float(sys.argv[4]), int(sys.argv[5]))
    motifValue = motifs[motifDictIndex]
# get navigational data
def getNavData():
    lats = []
    longs = []
    with open(latlongname, 'r') as csvfile:
        reader = csv.reader(csvfile, delimiter=',', quotechar='|')
        for row in reader:
            lats.append(float(row[0]))
            longs.append(float(row[1]))
    return lats, longs

def getClusterData(lats, longs, motifs=None):
    assignMapLongs = defaultdict(list)
    assignMapLats = defaultdict(list)
    with open(input_name, 'r') as instream:
        lines = instream.readlines()
        assigns = [int(val.strip()) for val in lines]
        for i,a in enumerate(assigns):
            assignMapLongs[a].append(longs[i])
            assignMapLats[a].append(lats[i])
    motifLats = {} # motif to lats
    motifLongs = {} # motif to longs
    endPointLats = {}
    endPointLongs = {}
    if motifs is not None:
        for k, incidents in motifs.items():
            motifLats[k] = []
            motifLongs[k] = []
            endPointLats[k] = []
            endPointLongs[k] = []
            for start,end in incidents:
                motifLats[k] += lats[start:end+1]
                motifLongs[k] += longs[start:end+1]
                endPointLats[k].append(lats[start])
                endPointLongs[k].append(longs[start])
                endPointLats[k].append(lats[end])
                endPointLongs[k].append(longs[end])
    return (assignMapLats, assignMapLongs), (motifLats, motifLongs, endPointLats, endPointLongs)

def plotValues(motifs=None):
    startPerc = 0
    endPerc = 1
    lats, longs = getNavData()
    assignData, motifData = getClusterData(lats, longs,motifs=motifs)
    assignMapLats, assignMapLongs = assignData
    start = int(startPerc * len(lats))
    end = int(endPerc * len(lats))
    long_min = min(longs[start:end])
    long_max = max(longs[start:end])
    long_center = (long_min + long_max)/2
    lat_min = min(lats[start:end])
    lat_max = max(lats[start:end])
    lat_center = (lat_min + lat_max)/2
    print long_min, long_max, lat_min, lat_max
    plt.figure(figsize=(50,50))
    m = Basemap(llcrnrlon=long_min,
                llcrnrlat=lat_min,
                urcrnrlon=long_max,
                urcrnrlat=lat_max,
                lat_0 = lat_center,
                lon_0 = long_center,
                projection='merc',
                resolution='h')
    assignMapLats, assignMapLongs = assignData
    keys = assignMapLongs.keys()
    for k in keys:
        x, y = m(assignMapLongs[k], assignMapLats[k])
        m.scatter(x,y,10,marker='|',color=colormap[k])
    plt.show()
    plt.savefig(output_name + "_assign.png")
    plt.clf()
    if motifs is not None:
        motifLats, motifLongs, endpointx, endpointy = motifData
        keys = motifLats.keys()
        for i,k in enumerate(keys):
            motifString = "%s" % list(k)
            x, y = m(motifLongs[k], motifLats[k])
            endX, endY = m(endpointy[k], endpointx[k])
            m.scatter(x,y,10,marker='|',color=colormap[i], label=motifString)
            m.scatter(endX, endY, 60, marker='|',color='black')
        art = []
        # lgd = plt.legend(loc=0, borderaxespad=0.)
        lgd = plt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)
        art.append(lgd)
        plt.savefig(output_name + "_motifs.png", additional_artists=art, bbox_inches="tight")
        plt.show()
plotValues(motifValue)